<div class="container">
    <ng-container *ngIf="this.dataSource">
        <div class="table">
            <mat-table #table [dataSource]="dataSource!" matSort>
                <ng-container matColumnDef="username">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> username </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.username}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="wpm">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> wpm </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.wpm}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="accuracy">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> accuracy </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.accuracy}} % </mat-cell>
                </ng-container>
                <ng-container matColumnDef="timestamp">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> date </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.timestamp}} </mat-cell>
                </ng-container>
                <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumns;">
                </mat-row>
            </mat-table>
            <div class="paginator">
                <div class="page-size">
                    <label for="page-size-select">
                        Results per page: 
                    </label>
                    <select name="page-size-select" [(ngModel)]="selectedPageSize" (ngModelChange)="fetchResults()">
                        <option *ngFor="let pageSizeOption of pageSizeOptions">
                            {{ pageSizeOption }}
                        </option>
                    </select>
                </div>
                <div class="current-page">
                    <span>Page {{paginationInfo!.currentPage + 1}} of {{paginationInfo?.totalPages}}</span>
                </div>
                <div class="pagination-btns">
                    <button class="pagination-btn" (click)="fetchResults()" [disabled]="paginationInfo?.isFirstPage" [ngClass]="{'disabled-btn': paginationInfo?.isFirstPage}">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M18.75 19.5l-7.5-7.5 7.5-7.5m-6 15L5.25 12l7.5-7.5" />
                        </svg>
                    </button>
                    <button class="pagination-btn" (click)="fetchResults(paginationInfo!.currentPage - 1)" [disabled]="paginationInfo?.isFirstPage" [ngClass]="{'disabled-btn': paginationInfo?.isFirstPage}">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
                        </svg>
                    </button>
                    <button class="pagination-btn" (click)="fetchResults(paginationInfo!.currentPage + 1)" [disabled]="paginationInfo?.isLastPage" [ngClass]="{'disabled-btn': paginationInfo?.isLastPage}">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
                        </svg>
                    </button>
                    <button class="pagination-btn" (click)="fetchResults(paginationInfo!.totalPages - 1)" [disabled]="paginationInfo?.isLastPage" [ngClass]="{'disabled-btn': paginationInfo?.isLastPage}">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 4.5l7.5 7.5-7.5 7.5m-6-15l7.5 7.5-7.5 7.5" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </ng-container>
    <ng-container *ngIf="!this.dataSource">
        <app-loading></app-loading>
    </ng-container>
    <ng-container *ngIf="this.dataSource?.data?.length == 0">
        <h2 class="no-results">No results available at the moment.</h2>
    </ng-container>
</div>
